<!-- JQuery script -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script>
    // Function to move the comment box when clicking reply
    $(document).ready(function() {
        $("#comments").on("click", ".reply", function(event){
            event.preventDefault();
            var form = $("#postcomment").clone(true);
            form.find('.parent').val($(this).parent().parent().attr('id'));
            $(this).parent().append(form);
        });
    });
</script>


{% extends 'base_loggedin.html' %}
{% block content %}

<!-- Task general information -->
<h1>{{ task.name }}</h1>
<p>
    {{ task.description }}
</p>

<a href="../"><< Back to project</a>
<br/>
<br/>

<!-- Task detailed information -->
<dl class="leftcolumn">
    <dt>Status:</dt>
    <dd>{% load ganttly_extras %}
        {% if task.is_completed %}
            Finished
        {% elif task.finish|is_overdue %}
            Overdue
        {% elif task.has_started %}
            Running
        {% else %}
            Upcoming
        {% endif %}
    </dd>
    <dt>Start:</dt><dd>{{ task.start }}</dd>
    <dt>Finish:</dt><dd>{{ task.finish }}</dd>
    <dt>Started?</dt><dd>{{ task.has_started }} <a href="start">[Start]</a></dd>
    <dt>Assigned to:</dt>
    <!-- shows list of users assigned to the task -->
        <dd>
            <ul>
                {% for user in task.assigned_to.all %}
                <li>
                    {{ user.first_name }} {{ user.last_name }}
                </li>
                {% endfor %}
            </ul>
        </dd>
</dl>

<!-- Columns where the comments take place -->
<dl class="midcolumn">
    <dt>Comments</dt>
        <dd>
            <!-- form for a new comment submit -->
            <br />
            <form id="postcomment" method="post" action="">
                {% csrf_token %}
                {{ form.as_p }}
                <input type="submit" value="Submit" />
            </form>
            
            <!-- comment tree -->
            <ul id="comments">
            {% for c in comments %}
                <li id="{{ c.id }}" style="margin-left:{{ c.depth|add:c.depth }}em;">
                    <b>{{ c.user }}</b><br/>
                    <i>{{ c.posted }}</i><br/>
                    <p>{{ c.comment }}</p>
                    <p><a href="" class="reply">Reply</a></p>
                </li>
            {% empty %}
                <li>No comments...</li>
            {% endfor %}
            </ul>
         
        </dd>
</dl>
</div>

<!-- File upload column -->
<div class="rightcolumn">
    <dt>Files</dt>
        <dd>
            <a href="#">Upload file</a>
            <br/><br/>
            <ul class="files">
                <li>
                    <b>First Lastname</b><br/>
                    <i>March 1, 2013 - 3:30px</i><br/>
                    <p>
                        This is a file
                    </p>
                    <a href="#">Download</a>
                </li>
                <li>
                    <b>First Lastname</b><br/>
                    <i>March 1, 2013 - 3:30px</i><br/>
                    <p>
                        This is a file
                    </p>
                    <a href="#">Download</a>
                </li>
                <li>
                    <b>First Lastname</b><br/>
                    <i>March 1, 2013 - 3:30px</i><br/>
                    <p>
                        This is a file
                    </p>
                    <a href="#">Download</a>
                </li>
                <li>
                    <b>First Lastname</b><br/>
                    <i>March 1, 2013 - 3:30px</i><br/>
                    <p>
                        This is a file
                    </p>
                    <a href="#">Download</a>
                </li>
                <li>
                    <b>First Lastname</b><br/>
                    <i>March 1, 2013 - 3:30px</i><br/>
                    <p>
                        This is a file
                    </p>
                    <a href="#">Download</a>
                </li>
            </ul>
        </dd>

</div>
{% endblock content %}
